import{a as q}from"./chunk-TIORADEJ.mjs";import{c as a}from"./chunk-YPRVBJBD.mjs";import{d as k,f as b,g as O,h as T,j as v,k as P,l as G}from"./chunk-YO7VNMQZ.mjs";import{a as f}from"./chunk-KRKHMMVN.mjs";import{a as w}from"./chunk-4NCTUR2D.mjs";import{b as h}from"./chunk-OLRL3QZY.mjs";import{b as y}from"./chunk-LQF2EBCE.mjs";import{a as _}from"./chunk-ZMWKA46Z.mjs";import{b as l,c as p,d as A}from"./chunk-QIZBLM6W.mjs";import{c as C}from"./chunk-DGFOO2VY.mjs";import{a as m}from"./chunk-Q43D55M4.mjs";import{a as g}from"./chunk-5IOCOOCF.mjs";import{b as c}from"./chunk-R7AH4Q5E.mjs";async function M(n){let{endlessConfig:t,accountAddress:o}=n,{data:e}=await l({endlessConfig:t,originMethod:"getInfo",path:`accounts/${c.from(o).toString()}`});return e}async function J(n){let{endlessConfig:t,accountAddress:o,options:e}=n;return A({endlessConfig:t,originMethod:"getModules",path:`accounts/${c.from(o).toString()}/modules`,params:{ledger_version:e?.ledgerVersion,start:e?.offset,limit:e?.limit??1e3}})}async function U(n){return n.options?.ledgerVersion!==void 0?S(n):_(async()=>S(n),`module-${n.accountAddress}-${n.moduleName}`,1e3*60*5)()}async function S(n){let{endlessConfig:t,accountAddress:o,moduleName:e,options:r}=n,{data:s}=await l({endlessConfig:t,originMethod:"getModule",path:`accounts/${c.from(o).toString()}/module/${e}`,params:{ledger_version:r?.ledgerVersion}});return s}async function X(n){let{endlessConfig:t,accountAddress:o,options:e}=n;return A({endlessConfig:t,originMethod:"getTransactions",path:`accounts/${c.from(o).toString()}/transactions`,params:{start:e?.offset,limit:e?.limit}})}async function Y(n){let{endlessConfig:t,accountAddress:o,options:e}=n;return A({endlessConfig:t,originMethod:"getResources",path:`accounts/${c.from(o).toString()}/resources`,params:{ledger_version:e?.ledgerVersion,start:e?.offset,limit:e?.limit??999}})}async function I(n){let{endlessConfig:t,accountAddress:o,resourceType:e,options:r}=n,{data:s}=await l({endlessConfig:t,originMethod:"getResource",path:`accounts/${c.from(o).toString()}/resource/${e}`,params:{ledger_version:r?.ledgerVersion}});return s.data}async function K(n){let{endlessConfig:t,authenticationKey:o,options:e}=n,r=await I({endlessConfig:t,accountAddress:"0x1",resourceType:"0x1::account::OriginatingAddress",options:e}),{address_map:{handle:s}}=r,i=c.from(o);try{let d=await q({endlessConfig:t,handle:s,data:{key:i.toString(),key_type:"address",value_type:"address"},options:e});return c.from(d)}catch(d){if(d instanceof m&&d.data.error_code==="table_item_not_found")return i;throw d}}async function Z(n){let{endlessConfig:t,accountAddress:o}=n,r={owner_address:{_eq:c.from(o).toStringLong()},amount:{_gt:0}},i=await a({endlessConfig:t,query:{query:P,variables:{where_condition:r}},originMethod:"getAccountTokensCount"});return i.current_token_ownerships_v2_aggregate.aggregate?i.current_token_ownerships_v2_aggregate.aggregate.count:0}async function ee(n){let{endlessConfig:t,accountAddress:o,options:e}=n,s={owner_address:{_eq:c.from(o).toStringLong()},amount:{_gt:0}};e?.tokenStandard&&(s.token_standard={_eq:e?.tokenStandard});let i={query:T,variables:{where_condition:s,offset:e?.offset,limit:e?.limit,order_by:e?.orderBy}};return(await a({endlessConfig:t,query:i,originMethod:"getAccountOwnedTokens"})).current_token_ownerships_v2}async function ne(n){let{endlessConfig:t,accountAddress:o,collectionAddress:e,options:r}=n,s=c.from(o).toStringLong(),i=c.from(e).toStringLong(),d={owner_address:{_eq:s},current_token_data:{collection_id:{_eq:i}},amount:{_gt:0}};r?.tokenStandard&&(d.token_standard={_eq:r?.tokenStandard});let u={query:v,variables:{where_condition:d,offset:r?.offset,limit:r?.limit,order_by:r?.orderBy}};return(await a({endlessConfig:t,query:u,originMethod:"getAccountOwnedTokensFromCollectionAddress"})).current_token_ownerships_v2}async function oe(n){let{endlessConfig:t,accountAddress:o,options:e}=n,s={owner_address:{_eq:c.from(o).toStringLong()},amount:{_gt:0}};e?.tokenStandard&&(s.current_collection={token_standard:{_eq:e?.tokenStandard}});let i={query:b,variables:{where_condition:s,offset:e?.offset,limit:e?.limit,order_by:e?.orderBy}};return(await a({endlessConfig:t,query:i,originMethod:"getAccountCollectionsWithOwnedTokens"})).current_collection_ownership_v2_view}async function te(n){let{endlessConfig:t,accountAddress:o}=n,e=c.from(o).toStringLong(),s=await a({endlessConfig:t,query:{query:G,variables:{address:e}},originMethod:"getAccountTransactionsCount"});return s.account_transactions_aggregate.aggregate?s.account_transactions_aggregate.aggregate.count:0}async function se(n){let{endlessConfig:t,accountAddress:o,coinId:e}=n,r=c.from(o).toStringLong(),{data:s}=await R({endlessConfig:t,accountAddress:r,options:{where:{coin_id:e}}});return s[0].balance&&s[0].metadata.decimals?parseInt(s[0].balance,10)/10**s[0].metadata.decimals:0}async function re(n){let{endlessConfig:t,accountAddress:o,options:e}=n,r=c.from(o).toStringLong(),{data:s}=await p({endlessConfig:t,originMethod:"getCoinsDataCreatedBy",path:`coins/created_by/${r}`,params:{page:e?.page,pageSize:e?.pageSize,coin:e?.where?.coin_id}});return s}async function R(n){let{endlessConfig:t,accountAddress:o,options:e}=n,r=c.from(o).toStringLong(),{data:s}=await p({endlessConfig:t,originMethod:"getAccountCoinsData",path:`accounts/${r}/coins`,params:{page:e?.page,pageSize:e?.pageSize,coin:e?.where?.coin_id}});return s}async function ce(n){let{endlessConfig:t,accountAddress:o}=n,e=c.from(o).toStringLong(),s=await a({endlessConfig:t,query:{query:k,variables:{address:e}},originMethod:"getAccountCoinsCount"});if(!s.current_fungible_asset_balances_aggregate.aggregate)throw Error("Failed to get the count of account coins");return s.current_fungible_asset_balances_aggregate.aggregate.count}async function ie(n){let{endlessConfig:t,accountAddress:o,options:e}=n,s={owner_address:{_eq:c.from(o).toStringLong()}},i={query:O,variables:{where_condition:s,offset:e?.offset,limit:e?.limit,order_by:e?.orderBy}};return(await a({endlessConfig:t,query:i,originMethod:"getAccountOwnedObjects"})).current_objects}async function de(n){let{endlessConfig:t,privateKey:o}=n,e=new w(o.publicKey());if(o instanceof h){let s=g.fromPublicKey({publicKey:e}).derivedAddress();return f.fromPrivateKey({privateKey:o,address:s})}if(o instanceof y){let r=g.fromPublicKey({publicKey:e});if(await E({authKey:r,endlessConfig:t})){let u=r.derivedAddress();return f.fromPrivateKey({privateKey:o,address:u,legacy:!1})}let i=g.fromPublicKey({publicKey:e.publicKey});if(await E({authKey:i,endlessConfig:t})){let u=i.derivedAddress();return f.fromPrivateKey({privateKey:o,address:u,legacy:!0})}}throw new Error(`Can't derive account from private key ${o}`)}async function E(n){let{endlessConfig:t,authKey:o}=n,e=await K({endlessConfig:t,authenticationKey:o.derivedAddress()});try{return await M({endlessConfig:t,accountAddress:e}),!0}catch(r){if(r.status===404)return!1;throw new Error(`Error while looking for an account info ${e.toString()}`)}}async function ae(n){let{endlessConfig:t,accountAddress:o,coinAddress:e}=n,{data:r}=await C({endlessConfig:t,originMethod:"getAccountsCoinBalance",path:`accounts/coins/${e}`,body:o});return r}export{M as a,J as b,U as c,X as d,Y as e,I as f,K as g,Z as h,ee as i,ne as j,oe as k,te as l,se as m,re as n,R as o,ce as p,ie as q,de as r,E as s,ae as t};
//# sourceMappingURL=chunk-DSILH5UU.mjs.map