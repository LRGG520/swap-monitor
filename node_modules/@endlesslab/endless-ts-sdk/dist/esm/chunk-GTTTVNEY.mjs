import{b as p}from"./chunk-I4NAVGRF.mjs";import{a as h}from"./chunk-KQGTQFQE.mjs";import{a as c}from"./chunk-USX52I62.mjs";import{a as m}from"./chunk-5IOCOOCF.mjs";import{a as g}from"./chunk-Y3FIGVYP.mjs";import{b as n}from"./chunk-H24X6T4W.mjs";import{bls12_381 as o}from"@noble/curves/bls12-381";var i=class i extends p{constructor(e){super();let t=n.fromHexInput(e);if(t.toUint8Array().length!==i.LENGTH)throw new Error(`PublicKey length should be ${i.LENGTH}`);this.key=t}verifySignature(e){let{message:t,signature:a}=e;if(!(a instanceof y))return!1;let u=c(t),f=n.fromHexInput(u).toUint8Array(),d=a.toUint8Array(),K=this.key.toUint8Array();return o.verify(d,f,K)}authKey(){return m.fromSchemeAndBytes({scheme:5,input:this.toUint8Array()})}toUint8Array(){return this.key.toUint8Array()}serialize(e){e.serializeBytes(this.key.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new i(t)}static isPublicKey(e){return e instanceof i}};i.LENGTH=48;var l=i,r=class r extends g{constructor(e){super();let t=n.fromHexInput(e);if(t.toUint8Array().length!==r.LENGTH)throw new Error(`PrivateKey length should be ${r.LENGTH}`);this.signingKey=t}static generate(){let e=o.utils.randomPrivateKey();return new r(e)}publicKey(){let e=o.getPublicKey(this.signingKey.toUint8Array());return new l(e)}sign(e){let t=c(e),a=n.fromHexInput(t).toUint8Array(),u=o.sign(a,this.signingKey.toUint8Array());return new y(u)}toUint8Array(){return this.signingKey.toUint8Array()}toString(){return this.signingKey.toString()}serialize(e){e.serializeBytes(this.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new r(t)}static isPrivateKey(e){return e instanceof r}};r.LENGTH=32;var A=r,s=class s extends h{constructor(e){super();let t=n.fromHexInput(e);if(t.toUint8Array().length!==s.LENGTH)throw new Error(`Signature length should be ${s.LENGTH}`);this.data=t}toUint8Array(){return this.data.toUint8Array()}serialize(e){e.serializeBytes(this.data.toUint8Array())}static deserialize(e){let t=e.deserializeBytes();return new s(t)}};s.LENGTH=96;var y=s;export{l as a,A as b,y as c};
//# sourceMappingURL=chunk-GTTTVNEY.mjs.map