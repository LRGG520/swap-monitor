{"version":3,"sources":["../../src/utils/miniprogramClient.ts"],"sourcesContent":["export type MiniprogramClientResponse<Res> = {\n  status: number;\n  statusText: string;\n  data: Res;\n  config?: any;\n  request?: any;\n  response?: any;\n  headers?: any;\n};\n\nexport type MiniprogramClientRequest = {\n  url: string;\n  method: \"GET\" | \"POST\";\n  body?: any;\n  params?: any;\n  headers?: any;\n  overrides?: any;\n};\n\nexport default function miniprogramClient<Res>(options: MiniprogramClientRequest): Promise<MiniprogramClientResponse<Res>> {\n\tconst { params, method, url, headers, body, overrides } = options;\n\tconst requestConfig = {\n\t\theaders,\n\t\tmethod,\n\t\turl,\n\t\tdata: body ?? params,\n\t\twithCredentials: overrides?.WITH_CREDENTIALS ?? true\n\t};\n  console.log('requestConfig: ', requestConfig);\n  Object.keys(requestConfig.data ?? {}).forEach((key) => {\n    if (requestConfig.data[key] === undefined) {\n      delete requestConfig.data[key];\n    }\n  });\n\n\treturn new Promise((resolve, reject) => {\n\t\ttry {\n      // @ts-ignore\n\t\t\twx.request({\n        ...requestConfig,\n      // @ts-ignore\n        success: (response) => {\n          console.log('response: ', response);\n          resolve({\n            status: response.statusCode,\n            statusText: response.errMsg,\n            data: response.data,\n            headers: response.header,\n            config: response\n          });\n        },\n        // @ts-ignore\n        fail: (error) => {\n          reject(error);\n        }\n      });\n\t\t} catch (error) {\n      reject(error)\n\t\t}\n\t});\n}\n"],"mappings":"AAmBe,SAARA,EAAwCC,EAA4E,CAC1H,GAAM,CAAE,OAAAC,EAAQ,OAAAC,EAAQ,IAAAC,EAAK,QAAAC,EAAS,KAAAC,EAAM,UAAAC,CAAU,EAAIN,EACpDO,EAAgB,CACrB,QAAAH,EACA,OAAAF,EACA,IAAAC,EACA,KAAME,GAAQJ,EACd,gBAAiBK,GAAW,kBAAoB,EACjD,EACC,eAAQ,IAAI,kBAAmBC,CAAa,EAC5C,OAAO,KAAKA,EAAc,MAAQ,CAAC,CAAC,EAAE,QAASC,GAAQ,CACjDD,EAAc,KAAKC,CAAG,IAAM,QAC9B,OAAOD,EAAc,KAAKC,CAAG,CAEjC,CAAC,EAEK,IAAI,QAAQ,CAACC,EAASC,IAAW,CACvC,GAAI,CAEH,GAAG,QAAQ,CACN,GAAGH,EAEH,QAAUI,GAAa,CACrB,QAAQ,IAAI,aAAcA,CAAQ,EAClCF,EAAQ,CACN,OAAQE,EAAS,WACjB,WAAYA,EAAS,OACrB,KAAMA,EAAS,KACf,QAASA,EAAS,OAClB,OAAQA,CACV,CAAC,CACH,EAEA,KAAOC,GAAU,CACfF,EAAOE,CAAK,CACd,CACF,CAAC,CACL,OAASA,EAAO,CACZF,EAAOE,CAAK,CAChB,CACD,CAAC,CACF","names":["miniprogramClient","options","params","method","url","headers","body","overrides","requestConfig","key","resolve","reject","response","error"]}