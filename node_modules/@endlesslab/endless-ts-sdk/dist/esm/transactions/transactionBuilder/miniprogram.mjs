import{a as f,c as C,e as $}from"../../chunk-BGSINN43.mjs";import"../../chunk-YN7JZDNQ.mjs";import{q as N,t as g}from"../../chunk-NDFXPSUK.mjs";import{a as M}from"../../chunk-DSILH5UU.mjs";import"../../chunk-TIORADEJ.mjs";import{b as W}from"../../chunk-AADPBGL3.mjs";import{a as R}from"../../chunk-YPRVBJBD.mjs";import"../../chunk-YO7VNMQZ.mjs";import"../../chunk-3SMHTMQH.mjs";import"../../chunk-AOD56HJK.mjs";import"../../chunk-KRKHMMVN.mjs";import"../../chunk-ECLPZ3CG.mjs";import"../../chunk-HNBCMUTG.mjs";import"../../chunk-3EGTUEWH.mjs";import"../../chunk-B4TGWP6T.mjs";import"../../chunk-PSOJ2Q5V.mjs";import"../../chunk-4NMDYPUD.mjs";import"../../chunk-FFPUBX3I.mjs";import"../../chunk-EACOSGMU.mjs";import{a as F}from"../../chunk-IQD4DV4A.mjs";import"../../chunk-UYVPNUH3.mjs";import"../../chunk-CFMGG54C.mjs";import"../../chunk-T2NK4HOP.mjs";import{a as G}from"../../chunk-2Y6GETDV.mjs";import{a as D}from"../../chunk-CR74RISD.mjs";import{c as h,d as w,e as S,f as E,g as B,h as x,i as b}from"../../chunk-REP4Z3MG.mjs";import"../../chunk-7YVNZXS3.mjs";import{a as P}from"../../chunk-YAZ76FZM.mjs";import"../../chunk-3KNJ4KRY.mjs";import"../../chunk-GWLZC53T.mjs";import"../../chunk-RFSO3JRG.mjs";import"../../chunk-5UW2J3ZQ.mjs";import"../../chunk-QEQ3A6VM.mjs";import"../../chunk-HEZ2ZYZA.mjs";import"../../chunk-KUX6GQ2E.mjs";import"../../chunk-OHUGTNKN.mjs";import"../../chunk-L3A5BWGA.mjs";import"../../chunk-JHAJVRFY.mjs";import"../../chunk-4NCTUR2D.mjs";import"../../chunk-OLRL3QZY.mjs";import"../../chunk-BVS7ECHS.mjs";import"../../chunk-IVVWQKCF.mjs";import"../../chunk-C4Y2KADZ.mjs";import"../../chunk-TACUSWEG.mjs";import"../../chunk-LQF2EBCE.mjs";import"../../chunk-CYWKCYY6.mjs";import"../../chunk-GTTTVNEY.mjs";import"../../chunk-I4NAVGRF.mjs";import"../../chunk-KQGTQFQE.mjs";import"../../chunk-USX52I62.mjs";import{a as T}from"../../chunk-ZMWKA46Z.mjs";import"../../chunk-N2FKVZ4D.mjs";import"../../chunk-QIZBLM6W.mjs";import"../../chunk-DGFOO2VY.mjs";import"../../chunk-W7LQSZ4I.mjs";import"../../chunk-GED6IT3S.mjs";import"../../chunk-RSKPHKJG.mjs";import"../../chunk-Q43D55M4.mjs";import"../../chunk-5IOCOOCF.mjs";import{b as s}from"../../chunk-R7AH4Q5E.mjs";import"../../chunk-FZY4PMEE.mjs";import"../../chunk-D726QCVU.mjs";import"../../chunk-MZ3AZ3QQ.mjs";import"../../chunk-LID3RY72.mjs";import"../../chunk-RIZM4VPI.mjs";import"../../chunk-R3T7RHLC.mjs";import"../../chunk-4WPQQPUF.mjs";import"../../chunk-2PISSJSZ.mjs";import"../../chunk-Y3FIGVYP.mjs";import{b as A}from"../../chunk-H24X6T4W.mjs";import"../../chunk-62YOTCF6.mjs";import"../../chunk-JL2XI2TF.mjs";import{g as y}from"../../chunk-V2ND42XG.mjs";import{b as l,c as I}from"../../chunk-LWKCWJBC.mjs";import"../../chunk-APPRGGHM.mjs";import"../../chunk-KDMSOCZY.mjs";async function on(n){if(N(n))return X(n);let{moduleAddress:t,moduleName:a,functionName:i}=g(n.function),e=await z({key:"entry-function",moduleAddress:t,moduleName:a,functionName:i,endlessConfig:n.endlessConfig,abi:n.abi,fetch:C});return L({...n,abi:e})}function L(n){let t=n.abi,{moduleAddress:a,moduleName:i,functionName:e}=g(n.function),r=f(n.typeArguments);if(r.length!==t.typeParameters.length)throw new Error(`Type argument count mismatch, expected ${t.typeParameters.length}, received ${r.length}`);let o=n.functionArguments.map((c,p)=>$(n.function,t,c,p,r));if(o.length!==t.parameters.length)throw new Error(`Too few arguments for '${a}::${i}::${e}', expected ${t.parameters.length} but got ${o.length}`);let u=E.build(`${a}::${i}`,e,r,o);if("multisigAddress"in n){let c=s.from(n.multisigAddress);return new S(new x(c,new b(u)))}return new w(u)}function X(n){return new h(new B(A.fromHexInput(n.bytecode).toUint8Array(),f(n.typeArguments),n.functionArguments))}async function v(n){let{endlessConfig:t,sender:a,payload:i,options:e,feePayerAddress:r}=n,o=async()=>y[t.network]?{chainId:y[t.network]}:{chainId:(await R({endlessConfig:t})).chain_id},u=async()=>e?.gasUnitPrice?{gasEstimate:e.gasUnitPrice}:{gasEstimate:(await W({endlessConfig:t})).gas_estimate},c=async()=>{let d=async()=>{if(e?.accountSequenceNumber!==void 0)return e.accountSequenceNumber;try{return(await M({endlessConfig:t,accountAddress:a})).sequence_number}catch(m){if("status"in m&&m.status===404)return 0;throw m}};if(r&&s.from(r).equals(s.ZERO))try{return await d()}catch{return 0}else return d()},[{chainId:p},{gasEstimate:_},U]=await Promise.all([o(),u(),c()]),{maxGasAmount:q,gasUnitPrice:k,expireTimestamp:O}={maxGasAmount:e?.maxGasAmount?BigInt(e.maxGasAmount):BigInt(2e5),gasUnitPrice:e?.gasUnitPrice??BigInt(_),expireTimestamp:e?.expireTimestamp??BigInt(Math.floor(Date.now()/1e3)+20)};return new D(s.from(a),BigInt(U),i,BigInt(q),BigInt(k),BigInt(O),new P(p))}async function sn(n){let{endlessConfig:t,sender:a,payload:i,options:e,feePayerAddress:r}=n,o=await v({endlessConfig:t,sender:a,payload:i,options:e,feePayerAddress:r});if("secondarySignerAddresses"in n){let u=n.secondarySignerAddresses?.map(c=>s.from(c))??[];return new G(o,u,n.feePayerAddress?s.from(n.feePayerAddress):void 0)}return new F(o,n.feePayerAddress?s.from(n.feePayerAddress):void 0)}async function z({key:n,moduleAddress:t,moduleName:a,functionName:i,endlessConfig:e,abi:r,fetch:o}){return r!==void 0?r:T(async()=>o(t,a,i,e),`${n}-${e.network}-${t}-${a}-${i}`,1e3*60*5)()}export{sn as buildTransaction,v as generateRawTransaction,on as generateTransactionPayload,L as generateTransactionPayloadWithABI};
//# sourceMappingURL=miniprogram.mjs.map